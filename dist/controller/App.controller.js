sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/VBox","sap/m/HBox","sap/m/Input","sap/m/Label","sap/m/Select","sap/m/Button","sap/m/Text","sap/ui/core/Item","sap/m/CheckBox","sap/m/RadioButton","sap/m/MessageToast","sap/ui/layout/Grid","sap/ui/layout/GridData"],function(e,t,o,i,n,s,a,l,d,c,r,p,u,m){"use strict";return e.extend("sap.ui.demo.walkthrough.controller.App",{onInit:function(){this.sectionCount=0;this.selectedSection=null;this._dialog=null;this.currentFormId=null;this.currentFormId=Date.now();this.fieldType=null},onAddSection:function(){const e=new u({id:"grid-"+this.sectionCount,defaultSpan:"L4 M6 S12",hSpacing:1,vSpacing:1});const t="Section "+(this.sectionCount+1);const o=new sap.m.Panel({headerToolbar:new sap.m.Toolbar({content:[new sap.m.Text({text:t}),new sap.m.ToolbarSpacer,new a({text:"Select",press:()=>{this._clearSelectedSections();o.addStyleClass("selectedSectionCard");this.selectedSection=e;p.show("Selected "+t)}})]}),content:[e],expandable:false,class:"sapUiResponsiveMargin sapUiTinyMarginBottom sapUiTinyMarginTop sapUiMediumPadding"});this.byId("mainVBox").addItem(o);this.selectedSection=e;this._clearSelectedSections();o.addStyleClass("selectedSectionCard");this.sectionCount++;this.saveFormToLocalStorage()},_clearSelectedSections:function(){const e=this.byId("mainVBox");if(!e)return;e.getItems().forEach(e=>{if(e.removeStyleClass){e.removeStyleClass("selectedSectionCard")}})},_addFieldToGrid:function(e){if(!this.selectedSection){p.show("Please select a section first.");return}const o=new t({layoutData:new m({span:"L4 M6 S12"}),items:[e]});this.selectedSection.addContent(o);this.saveFormToLocalStorage()},onAddTextField:function(){this._openFieldConfigDialog("text")},onAddDropdown:function(){this._openFieldConfigDialog("dropdown")},onAddCheckbox:function(){this._openFieldConfigDialog("checkbox")},onAddRadioButton:function(){this._openFieldConfigDialog("radio")},onAddNumberField:function(){this._openFieldConfigDialog("number")},onAddEmailField:function(){this._openFieldConfigDialog("email")},saveFormToLocalStorage:function(){const e=this._generateFormObject();const t=localStorage.getItem("forms");let o=t?JSON.parse(t):[];const i=o.findIndex(t=>t.id===e.id);if(i>-1){o[i]=e}else{o.push(e)}localStorage.setItem("forms",JSON.stringify(o));p.show("Form saved to localStorage.")},_generateFormObject:function(){const e=this.byId("mainVBox");const t=[];let o=1;let i=1;e.getItems().forEach(e=>{if(e.isA("sap.m.Panel")){const n=`sec${o++}`;const s=e.getContent()[0];const a=[];s.getContent().forEach(e=>{const t=e.getItems()[0];const o=t.getItems()[0].getText();const n=t.getItems()[1];let s={id:`q${i++}`,label:o,required:true};if(n.isA("sap.m.Input")){const e=n.getType?n.getType():"Text";s.type=e.toLowerCase()==="email"?"email":e.toLowerCase()}else if(n.isA("sap.m.Select")){s.type="dropdown";s.options=n.getItems().map(e=>e.getText())}else if(n.isA("sap.m.VBox")){const e=n.getItems();if(e.length&&e[0].isA("sap.m.CheckBox")){s.type="checkbox";s.options=e.map(e=>e.getText())}else if(e.length&&e[0].isA("sap.m.RadioButton")){s.type="radio";s.options=e.map(e=>e.getText())}}a.push(s)});t.push({id:n,sectionTitle:e.getHeaderToolbar().getContent()[0].getText(),questions:a})}});return{id:this.currentFormId,title:this.byId("formTitleInput").getValue().trim()||"Untitled Form",sections:t}},_openFieldConfigDialog:function(e){this.fieldType=e;this._getDialog().then(function(t){const o=this.getView().getId();sap.ui.core.Fragment.byId(o,"fieldLabelInput").setValue("");sap.ui.core.Fragment.byId(o,"fieldPlaceholderInput")?.setValue("");sap.ui.core.Fragment.byId(o,"fieldOptionsInput")?.setValue("");sap.ui.core.Fragment.byId(o,"fieldCheckbox")?.setSelected(false);t.setModel(new sap.ui.model.json.JSONModel({fieldType:e}));t.open()}.bind(this))},_getDialog:function(){if(this._dialog){return Promise.resolve(this._dialog)}return new Promise(function(e){sap.ui.core.Fragment.load({id:this.getView().getId(),name:"sap.ui.demo.walkthrough.view.FieldConfigDialog",controller:this}).then(function(t){this._dialog=t;this.getView().addDependent(t);e(t)}.bind(this))}.bind(this))},onDialogOk:function(){const e=this.getView().getId();const o=sap.ui.core.Fragment.byId(e,"fieldLabelInput").getValue();const a=sap.ui.core.Fragment.byId(e,"fieldPlaceholderInput")?.getValue()||"";const l=sap.ui.core.Fragment.byId(e,"fieldOptionsInput")?.getValue()||"";const u=sap.ui.core.Fragment.byId(e,"fieldCheckbox")?.getSelected();if(!o&&this.fieldType!=="checkbox"){p.show("Please enter a label.");return}if((this.fieldType==="dropdown"||this.fieldType==="radio"||this.fieldType==="checkbox")&&l.trim()===""){p.show("Please enter options separated by commas.");return}let m;switch(this.fieldType){case"text":m=new i({placeholder:a});break;case"dropdown":const e=new s;l.split(",").map(e=>e.trim()).filter(Boolean).forEach(t=>{e.addItem(new d({key:t,text:t}))});m=e;break;case"checkbox":const o=new t;l.split(",").map(e=>e.trim()).filter(Boolean).forEach(e=>{o.addItem(new c({text:e,selected:false}))});m=o;break;case"radio":const n=new t;l.split(",").map(e=>e.trim()).filter(Boolean).forEach(e=>{n.addItem(new r({text:e,groupName:"radioGroup-"+Math.random().toString(36).substr(2,5)}))});m=n;break;case"number":m=new i({type:"Number",placeholder:a});break;case"email":m=new i({type:"Email",placeholder:a});break;default:p.show("Unsupported field type");return}const h=new t({items:[new n({text:o}),m]});this._addFieldToGrid(h);this._dialog.close()},onDialogCancel:function(){this._dialog.close()},onCreateForm:function(){this.saveFormToLocalStorage();this._navigateToAppView()}})});
//# sourceMappingURL=App.controller.js.map